# 阿飞自用签到助手插件

## 功能介绍

站点签到助手是一个支持多个PT站点自动签到的MoviePilot V2插件。目前支持以下站点：

- **HH** (hhanclub.top) - 使用视觉识别技术进行签到
- **OU** (ourbits.club) - 基于页面元素定位进行签到  
- **TTG** (totheglory.im) - 智能查找签到按钮进行签到

## 安装要求

插件需要以下依赖包：

- selenium >= 4.0.0
- webdriver-manager >= 3.8.0
- opencv-python-headless >= 4.5.0 (仅HH站点需要)
- pyautogui >= 0.9.50 (仅HH站点需要)
- numpy >= 1.20.0 (仅HH站点需要)

## 配置说明

### 1. Cookie配置方式

插件支持多种Cookie配置方式，按优先级排序：

1. **MoviePilot站点管理**（推荐）
   - 在MoviePilot的"站点管理"中配置站点Cookie
   - 插件会自动获取并使用这些Cookie
   - 无需手动配置，最为便捷

2. **手动Cookie配置**
   - 在插件配置界面的"手动Cookie配置"部分填写
   - 支持HH、OU、TTG三个预设站点的Cookie配置
   - 当MP站点管理中没有对应站点时使用

3. **自定义站点配置**
   - 支持任意站点的配置
   - 格式：`站点名称|域名|Cookie`

### 2. HH站点特殊要求

HH站点使用视觉识别技术，需要额外准备：

- `red_dot_template.png` - 签到按钮的模板图片，用于视觉识别
- 该文件应放置在插件目录下（`plugins.v2/qdsignin/`）

### 3. 自定义站点配置

#### 配置格式

在插件配置界面的"自定义站点配置"文本框中，按以下格式填写：

```
站点名称|域名|Cookie
```

#### 配置示例

```
MyPT|https://mypt.com/|session_id=abc123;user_id=456;auth_token=xyz789
AnotherSite|https://another.site/|login_hash=def456;user_name=test
```

### 4. Cookie获取方法

1. 登录目标站点
2. 打开浏览器开发者工具（F12）
3. 切换到Network标签
4. 刷新页面
5. 找到主页面请求，查看Request Headers中的Cookie
6. 复制Cookie值到对应配置中

### 5. 插件配置

在MoviePilot管理界面中配置插件：

- **启用插件**: 开启/关闭插件功能
- **发送通知**: 签到完成后是否发送通知消息
- **执行周期**: 使用cron表达式设置定时签到时间，留空则随机执行
- **立即运行一次**: 保存配置后立即执行一次签到
- **签到站点**: 选择需要签到的预设站点
- **手动Cookie配置**: 填写HH、OU、TTG站点的Cookie
- **自定义站点配置**: 填写自定义站点的配置信息

## 使用方法

1. 在MoviePilot站点管理中配置站点（推荐），或在插件中手动配置Cookie
2. 对于HH站点，准备签到按钮的模板图片
3. 在插件配置页面选择要签到的站点
4. 设置执行周期或使用默认随机时间
5. 启用插件

## 注意事项

1. **Cookie有效性**: 请确保Cookie配置是有效的，过期的Cookie会导致签到失败
2. **网络环境**: 插件需要能够正常访问目标站点
3. **浏览器依赖**: 插件使用Chrome浏览器进行自动化操作，需要系统已安装Chrome
4. **资源占用**: 签到过程会启动浏览器，可能占用一定的系统资源
5. **频率控制**: 插件会在站点间添加延时，避免频繁请求
6. **配置优先级**: 优先使用MP站点管理中的Cookie，其次使用手动配置的Cookie

## 故障排除

### 常见问题

1. **ChromeDriver错误**: 插件会自动下载管理ChromeDriver，确保网络连接正常
2. **Cookie失效**: 在MP站点管理或插件配置中更新Cookie
3. **签到失败**: 检查站点是否可正常访问，Cookie是否有效
4. **视觉识别失败**: 对于HH站点，确保模板图片准确且清晰
5. **自定义站点配置错误**: 确保配置格式正确，使用"|"分隔符，Cookie格式正确
6. **自定义站点签到失败**: 检查域名是否正确，Cookie是否有效，站点是否支持自动签到
7. **MP站点Cookie获取失败**: 确保在MP站点管理中正确配置了站点信息

### 日志查看

插件运行日志可在MoviePilot日志中查看，包含详细的执行过程和错误信息。

## 版本历史

- **v1.2**: 优化Cookie获取方式，优先使用MP站点管理Cookie，支持手动填写Cookie，移除Cookie文件依赖
- **v1.1**: 新增自定义站点配置功能，支持手动填写站点域名和Cookie
- **v1.0**: 初始版本，支持HH、OU、TTG三个站点的自动签到功能

## 作者信息

- **作者**: A-FEI-
- **GitHub**: https://github.com/nodesire7
